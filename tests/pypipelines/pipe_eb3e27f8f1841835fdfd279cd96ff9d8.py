# Pipe pipe_eb3e27f8f1841835fdfd279cd96ff9d8 generated by pipe2py

from pipe2py import Context
from pipe2py.modules.pipeforever import pipe_forever
from pipe2py.modules.pipeurlinput import pipe_urlinput
from pipe2py.modules.pipefetchdata import pipe_fetchdata
from pipe2py.modules.pipetextinput import pipe_textinput
from pipe2py.modules.pipefilter import pipe_filter
from pipe2py.modules.piperename import pipe_rename
from pipe2py.modules.piperegex import pipe_regex
from pipe2py.modules.pipeoutput import pipe_output

def pipe_eb3e27f8f1841835fdfd279cd96ff9d8(context=None, _INPUT=None, conf=None, **kwargs):
    # todo: insert pipeline description here
    conf = conf or {}

    if context.describe_input:
        return [(u'', u'q', u'Caption search term', u'text', u'maverick'), (u'', u'url', u'Caption URL', u'url', u'file://data/rsc-ne-scotland.org.uk_mashe_ititle_xml_jisc10bean.xml')]

    forever = pipe_forever()


    sw_521 = pipe_urlinput(
        context, forever, conf=dict(default=dict(type='url', value='file://data/rsc-ne-scotland.org.uk_mashe_ititle_xml_jisc10bean.xml'), position=dict(type='number', value=''), prompt=dict(type='text', value='Caption URL'), name=dict(type='text', value='url'), debug=dict(type='url', value='')))

    sw_572 = pipe_fetchdata(
        context, forever, URL=sw_521, conf=dict(URL=dict(terminal='URL', type='url'), path=dict(type='text', value='body.div.p')))

    sw_621 = pipe_textinput(
        context, forever, conf=dict(default=dict(type='text', value='maverick'), position=dict(type='number', value=''), prompt=dict(type='text', value='Caption search term'), name=dict(type='text', value='q'), debug=dict(type='text', value='')))

    sw_584 = pipe_filter(
        context, sw_572, RULE_1_value=sw_621, conf=dict(COMBINE=dict(type='text', value='and'), MODE=dict(type='text', value='permit'), RULE=[dict(field=dict(type='text', value='content'), value=dict(terminal='RULE_1_value', type='text'), op=dict(type='text', value='contains'))]))

    sw_595 = pipe_rename(
        context, sw_584, conf=dict(RULE=[dict(newval=dict(type='text', value='ctime'), field=dict(type='text', value='begin'), op=dict(type='text', value='copy')), dict(newval=dict(type='text', value='title'), field=dict(type='text', value='content'), op=dict(type='text', value='copy'))]))

    sw_606 = pipe_regex(
        context, sw_595, conf=dict(RULE=[dict(field=dict(type='text', value='ctime'), match=dict(type='text', value='(.*)'), replace=dict(type='text', value='&time=$1'))]))

    _OUTPUT = pipe_output(
        context, sw_606, conf=dict())

    return _OUTPUT


if __name__ == "__main__":
    context = Context()
    pipeline = pipe_eb3e27f8f1841835fdfd279cd96ff9d8(context, None)

    for i in pipeline:
        print i
